{% extends "layouts/wizard.tmpl" %}

{% block wizardDescription %}{{ formTitle }}{% endblock %}

{% block wizardBody %}
<form id="pnForm">
  <div class="container" width="60%">
    <div class="row mb-3" style="display: flex; align-items: center; justify-content: center;">
      <button type="button" class="btn" style="width: 30px; height: 30px; border-radius: 100%; align-items: center; display: inline-flex; justify-content: center; color: #3aaf85; border-color: #3aaf85;" data-bs-trigger="focus" data-bs-placement="right" data-bs-toggle="popover" data-bs-title="Ajuda" data-bs-content="Texto de ajuda">?</button>
      <label for="propertyArea" class="col-sm-2 col-form-label">{{ propertyArea }}</label>
      <span class="col-sm-4">
        <input id="propertyArea" name="propertyArea" class="form-control" type="number" title="{{ propertyArea }}"
          placeholder="ex: 10.0 ha">
      </span>
    </div>
    <div class="row mb-3" style="display: flex; align-items: center; justify-content: center;">
      <button type="button" class="btn" style="width: 30px; height: 30px; border-radius: 100%; align-items: center; display: inline-flex; justify-content: center; color: #3aaf85; border-color: #3aaf85;" data-bs-trigger="focus" data-bs-placement="right" data-bs-toggle="popover" data-bs-title="Ajuda" data-bs-content="Texto de ajuda">?</button>
      <label for="projectArea" class="col-sm-2 col-form-label">{{ projectArea }}</label>
      <div class="col-sm-4">
        <input id="projectArea" name="projectArea" class="form-control" type="number" title="{{ projectArea }}"
          placeholder="ex: 2.0 ha">
      </div>

      <!-- <input type="submit" value="Confirmar" /> -->
</form>
{% endblock wizardBody %}

{% block wizardConfig %}
<script>

  let sAction = '/callback/areas';
  const sendData = () => { // mgd 2023.11.13
    let sParams = '?';
    for (const [key, value] of new FormData(wzdControl.ge('pnForm'))) {
      sParams += `${key}=${value}&`;
    }
    const fSuccess = (sRsp) => {
      if (sRsp.toUpperCase() == 'OK') {
        window.location = wzdControl.nextPageHref
      } else {
        wzdControl.messageError(sRsp);
      }
    }
    wzdControl.fetchObject(sAction + sParams.slice(0, -1), fSuccess, 'Erro nas medidas fornecidas.', null, { type: 'text' });
    return false;
  }

  wzdControl.initPage({
    mode: wzdControl.mode.CUSTOM,
    nextPage: 'rsp-goal.html',
    onNext: () => { sendData(); return false; },
    help: `callback/help?id=${location.pathname.substring(location.pathname.lastIndexOf("/") + 1).replace('.html', '')}`
  });


</script>
{% endblock %}

{# eof #}